<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Preview Data KPI</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  table { border-collapse: collapse; width: 100%; margin-top: 20px; }
  th, td { border: 1px solid #aaa; padding: 6px; text-align: center; }
  th { background: #eee; }
</style>

</head>
<body>

<h2>Preview Data AS4:BL62 dari Sheet "T.UP3"</h2>
<p>Jika tabel tampil benar, kita lanjut buat grafik.</p>

<table id="dataTable"></table>

<script>
const excelURL = "https://raw.githubusercontent.com/UP3Tolis/DASHBOARD/main/NKO%20UP3%20TLI.xlsx";

function loadExcel() {
  fetch(excelURL)
    .then(res => res.arrayBuffer())
    .then(buffer => {
      const workbook = XLSX.read(buffer, { type: "array" });
      const sheet = workbook.Sheets["T.UP3"]; // PENTING: pilih sheet ini

      // Ambil range AS4:BL62
      const range = XLSX.utils.sheet_to_json(sheet, {
        header: 1,
        range: "AS4:BL62" // Range sesuai permintaan
      });

      renderTable(range);
    });
}

function renderTable(data) {
  const table = document.getElementById("dataTable");
  table.innerHTML = "";

  data.forEach(row => {
    const tr = document.createElement("tr");
    row.forEach(cell => {
      const td = document.createElement("td");
      td.textContent = cell !== undefined ? cell : "";
      tr.appendChild(td);
    });
    table.appendChild(tr);
  });
}

loadExcel();
</script>

</body>
</html>
